<div class="orders-page">
    <div class="orders-hero">
        <div class="container hero-content">
            <h1>My Orders</h1>
            <p>Track and manage your recent purchases</p>
        </div>
    </div>

    <div class="container main-content">
        <div *ngIf="errorMessage" class="error-alert">{{ errorMessage }}</div>

        <ng-container *ngIf="orders$ | async as orders; else loadingTpl">
            <div class="orders-list" *ngIf="orders.length > 0; else emptyOrders">
                @for (order of orders; track order.id) {
                <div class="order-card">
                    <div class="order-header">
                        <div>
                            <h3>Order #{{ order.order_number }}</h3>
                            <p class="order-date">{{ order.created_at | date }}</p>
                        </div>

                        <span class="status-badge" [ngClass]="order.status">
                            {{ order.status }}
                        </span>
                    </div>

                    <div class="order-products">
                        @for (item of order.items; track item.id) {
                        <div class="product-row">
                            <div class="product-name">
                                {{ item.display_name }}
                            </div>
                            <div class="product-qty">
                                Qty: {{ item.quantity }}
                            </div>
                        </div>
                        }
                    </div>

                    <div class="order-footer">
                        <div class="order-total">
                            Total: â‚¹{{ order.total_price | number:'1.2-2' }}
                        </div>

                        <div class="order-actions">
                            <button class="btn track-btn" [routerLink]="['/orders/track', order.id]">Track
                                Order</button>
                            <button class="btn cancel-btn" *ngIf="order.status === 'pending'"
                                (click)="cancelOrder(order.id)">
                                Cancel Order
                            </button>
                        </div>
                    </div>
                </div>
                }
            </div>

            <ng-template #emptyOrders>
                <div class="empty-state">
                    <div class="empty-icon">ðŸ“¦</div>
                    <h2>No orders yet</h2>
                    <p>It looks like you haven't placed any orders yet. Start shopping to find your next favorite items!
                    </p>
                    <button class="shop-btn" routerLink="/categories">Start Shopping</button>
                </div>
            </ng-template>
        </ng-container>

        <ng-template #loadingTpl>
            <div *ngIf="loading" class="loading-state">
                <div class="spinner"></div>
                <p>Fetching your orders...</p>
            </div>
        </ng-template>
    </div>
</div>