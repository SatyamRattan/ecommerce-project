<div class="wishlist-page">
    <div class="wishlist-hero">
        <div class="container hero-content">
            <h1>My Wishlist</h1>
            <p>Your curated collection of premium favorites</p>
        </div>
    </div>

    <div class="container main-content">
        <ng-container *ngIf="wishlistItems$ | async as items; else loading">
            <div class="wishlist-list" *ngIf="items.length > 0; else emptyWishlist">
                @for (item of items; track item.id) {
                <div class="wishlist-item-card">
                    <div class="item-visual">
                        <img [src]="item.image || item.variant?.image || item.product?.image_url || 'assets/images/placeholder.jpg'"
                            [alt]="item.product_name || item.product?.name">
                    </div>

                    <div class="item-info">
                        <div class="item-main">
                            <span class="category">{{ item.category_name || item.product?.category?.name || 'Category'
                                }}</span>
                            <h3 class="product-name">{{ item.product_name || item.product?.name }}</h3>
                            <div class="variant-chips" *ngIf="item.variant">
                                <span class="chip">{{ item.variant.color }}</span>
                            </div>
                        </div>

                        <div class="item-price">
                            <span class="price">₹{{ (item.price || item.product?.discount_price ||
                                item.product?.base_price || 0) | number:'1.2-2' }}</span>
                        </div>
                    </div>

                    <div class="item-actions">
                        <button class="action-btn cart-btn"
                            [routerLink]="['/product', item.product?.id || item.product]">
                            Move to Cart
                        </button>
                        <button class="action-btn remove-btn" (click)="removeItem(item.id)" aria-label="Remove item">
                            <svg viewBox="0 0 24 24" width="18" height="18" fill="none" stroke="currentColor"
                                stroke-width="2">
                                <path
                                    d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"
                                    stroke-linecap="round" stroke-linejoin="round" />
                            </svg>
                            <span>Remove</span>
                        </button>
                    </div>
                </div>
                }
            </div>

            <ng-template #emptyWishlist>
                <div class="empty-state">
                    <div class="empty-icon">❤️</div>
                    <h2>Your wishlist is empty</h2>
                    <p>Discover our latest collections and start saving your favorites today.</p>
                    <button class="shop-btn" routerLink="/categories">Start Shopping</button>
                </div>
            </ng-template>
        </ng-container>

        <ng-template #loading>
            <div class="loading-state">
                <div class="spinner"></div>
                <p>Loading your wishlist...</p>
            </div>
        </ng-template>
    </div>
</div>